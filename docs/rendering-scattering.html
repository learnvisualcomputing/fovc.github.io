<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>15&nbsp; Scattering – Foundations of Visual Computing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./rendering-rte.html" rel="next">
<link href="./rendering-absorption.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-485d01fc63b59abcd3ee1bf1e8e2748d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./rendering.html">Rendering</a></li><li class="breadcrumb-item"><a href="./rendering-scattering.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Scattering</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Foundations of Visual Computing</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">An Invitation to Visual Computing</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./hvs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Human Visual System</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hvs-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">From Light to Vision</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hvs-receptor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Photoreceptors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hvs-color.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Color Vision</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hvs-colorimetry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Colorimetry</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hvs-retcomp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Models for Retinal Computation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hvs-adaptation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Visual Adaptations and Constancy</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./rendering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rendering</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Overview</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-radiometry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Radiometry and Photometry</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-lightfield.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Light Field</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-surfacescattering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">The Rendering Equation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-surfacemodeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Modeling Material Surface</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-sss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Subsurface and Volume Scattering</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-absorption.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Absorption</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-scattering.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Scattering</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-rte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Radiative Transfer Equation and Volume Rendering</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./imaging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Imaging</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./imaging-optics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Imaging Optics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./imaging-sensor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Image Sensor Architecture</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./imaging-noises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Noises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./imaging-isp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Image Signal Processing</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./display.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Display</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./display-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Basic Principles</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./display-impl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Implementation Technologies</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-chpt-mat-vs-sca-intuition" id="toc-sec-chpt-mat-vs-sca-intuition" class="nav-link active" data-scroll-target="#sec-chpt-mat-vs-sca-intuition"><span class="header-section-number">15.1</span> Scattering by a Particle vs.&nbsp;a Collection of Particles</a>
  <ul class="collapse">
  <li><a href="#multiple-scattering" id="toc-multiple-scattering" class="nav-link" data-scroll-target="#multiple-scattering"><span class="header-section-number">15.1.1</span> Multiple Scattering</a></li>
  <li><a href="#interference-and-coherence" id="toc-interference-and-coherence" class="nav-link" data-scroll-target="#interference-and-coherence"><span class="header-section-number">15.1.2</span> Interference and Coherence</a></li>
  </ul></li>
  <li><a href="#sec-chpt-mat-vs-sca-single" id="toc-sec-chpt-mat-vs-sca-single" class="nav-link" data-scroll-target="#sec-chpt-mat-vs-sca-single"><span class="header-section-number">15.2</span> A Single Scattering Event</a>
  <ul class="collapse">
  <li><a href="#sec-chpt-mat-vs-sca-single-coeff" id="toc-sec-chpt-mat-vs-sca-single-coeff" class="nav-link" data-scroll-target="#sec-chpt-mat-vs-sca-single-coeff"><span class="header-section-number">15.2.1</span> Scattering Efficiency and Coefficient</a></li>
  </ul></li>
  <li><a href="#sec-chpt-mat-vs-sca-single-pf" id="toc-sec-chpt-mat-vs-sca-single-pf" class="nav-link" data-scroll-target="#sec-chpt-mat-vs-sca-single-pf"><span class="header-section-number">15.3</span> Scattering Direction Distribution: Phase Function</a>
  <ul class="collapse">
  <li><a href="#phase-function-vs.-brdf" id="toc-phase-function-vs.-brdf" class="nav-link" data-scroll-target="#phase-function-vs.-brdf"><span class="header-section-number">15.3.1</span> Phase Function vs.&nbsp;BRDF</a></li>
  <li><a href="#sec-chpt-mat-vs-sca-single-pf-iso" id="toc-sec-chpt-mat-vs-sca-single-pf-iso" class="nav-link" data-scroll-target="#sec-chpt-mat-vs-sca-single-pf-iso"><span class="header-section-number">15.3.2</span> Isotropic Medium and Isotropic Scatters</a></li>
  </ul></li>
  <li><a href="#sec-chpt-mat-vs-sca-models" id="toc-sec-chpt-mat-vs-sca-models" class="nav-link" data-scroll-target="#sec-chpt-mat-vs-sca-models"><span class="header-section-number">15.4</span> Common Models and General “Rules”</a>
  <ul class="collapse">
  <li><a href="#small-particle-rayleigh-scattering" id="toc-small-particle-rayleigh-scattering" class="nav-link" data-scroll-target="#small-particle-rayleigh-scattering"><span class="header-section-number">15.4.1</span> Small-Particle (Rayleigh) Scattering</a></li>
  <li><a href="#impact-of-particle-size" id="toc-impact-of-particle-size" class="nav-link" data-scroll-target="#impact-of-particle-size"><span class="header-section-number">15.4.2</span> Impact of Particle Size</a></li>
  <li><a href="#impact-of-refractive-index" id="toc-impact-of-refractive-index" class="nav-link" data-scroll-target="#impact-of-refractive-index"><span class="header-section-number">15.4.3</span> Impact of Refractive Index</a></li>
  <li><a href="#aspherical-particles" id="toc-aspherical-particles" class="nav-link" data-scroll-target="#aspherical-particles"><span class="header-section-number">15.4.4</span> Aspherical Particles</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./rendering.html">Rendering</a></li><li class="breadcrumb-item"><a href="./rendering-scattering.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Scattering</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-chpt-mat-vs-sca" class="quarto-section-identifier"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Scattering</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="hidden">
<p><span class="math display">\[
\def\oi{{\omega_i}}
\def\os{{\omega_s}}
\def\Oi{{\Omega_i}}
\def\Os{{\Omega_s}}
\def\d{{\text{d}}}
\def\D{{\Delta}}
\def\do{{\d\omega}}
\def\Do{{\Delta\omega}}
\def\doi{{\d\omega_i}}
\def\dos{{\d\omega_s}}
\def\Doi{{\D\omega_i}}
\def\Dos{{\D\omega_s}}
\def\H{{\mathbf{H}}}
\newcommand{\cM}{\mathcal{M}}
\newcommand{\cL}{\mathcal{L}}
\]</span></p>
</div>
<p>Scattering is much more difficult to reason about than absorption, primarily because a scattered photon is not “dead” and continues to participate in light-matter interaction. The way to study scattering is to first understand the behavior of a single scattering event and then consider the overall behavior of a large of collection of particles.</p>
<p>This section focuses a single scattering event (<a href="#sec-chpt-mat-vs-sca-single" class="quarto-xref"><span>Section 15.2</span></a>), and the next section discusses the general case where a large collection of particles interacts with photons. Before all these, though, it is useful to first build some intuitions as to why there is a distinction between a single scattering event and scattering by a particle collection and explicitly lay out the assumptions made for the rest of our discussions (<a href="#sec-chpt-mat-vs-sca-intuition" class="quarto-xref"><span>Section 15.1</span></a>).</p>
<section id="sec-chpt-mat-vs-sca-intuition" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="sec-chpt-mat-vs-sca-intuition"><span class="header-section-number">15.1</span> Scattering by a Particle vs.&nbsp;a Collection of Particles</h2>
<p>In geometric optics terms, scattering can be thought of as an event that takes place between a photon and a particle. In the real world, however, objects and media are usually made of a large collection of particles, which introduces two complications: multiple scattering and interference.</p>
<section id="multiple-scattering" class="level3" data-number="15.1.1">
<h3 data-number="15.1.1" class="anchored" data-anchor-id="multiple-scattering"><span class="header-section-number">15.1.1</span> Multiple Scattering</h3>
<p>First, it is possible that a scattered photon, after traveling a certain distance, meets another particle and gets scattered again. This makes it considerably more difficult to analyze the effect of scattering by a medium than does the scattering of a single particle.</p>
<div id="fig-haze_scattering" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-haze_scattering-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figs/haze_scattering.svg" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-haze_scattering-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.1: Left: The atmospheric scattering of the sand coming from the Sahara during Harmattan glows in the sun and gives a hazy view of the remote mountains. Nigeria’s National Mosque is in the foreground; from . Right: illustrations of the glow of the sun and the haze. Both are due to scattering, and the difference is purely visual but not fundamental.
</figcaption>
</figure>
</div>
<p>Look at <a href="#fig-haze_scattering" class="quarto-xref">Figure&nbsp;<span>15.1</span></a> (left) taken during Harmattan, where the atmosphere is full of sand and dust blown from the Sahara. The large collection of particles in the atmosphere scatters light, glowing the sun and giving the remote mountains a hazy view. The right panel illustrates the scattering events that give rise to the glow and the haze.</p>
<p>Without scattering, sunlight enters the eye directly. With scattering, some photons from the sun are first knocked out of the view and could potentially be then scattered again back to the eye. Some photons that enter the eye might even come from nearby objects other than the sun. The scattering creates a glow around the sun, and, for the observer, the sun appears larger than it actually is. The hazy view of the mountains is created by exactly the same scattering processes. The photons that enter the eyes are mixed up from different parts of the mountains and from other objects. The mountains appear hazy rather than glowing as the sun does simply because the sun has a higher brightness contrast against the background than does a region on the mountain. So the distinction between “glow” and “haze” is nothing more than a visual difference at a superficial level rather than anything deeper in physics.</p>
<p>You can see why multiple scattering by large collections of particles poses challenges to our analysis. If a photon is scattered once in the medium, the only effect of scattering would be to knock photons out of our line of sight, and thus, remote objects would only look dimmer rather than hazy. In this case, scattering would function exactly like absorption, for modeling purposes at least. With multiple scattering, we have to track not only photons that are scattered out but also photons that are scattered into the rays that enter our eyes<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. This is a daunting task considering that we are usually dealing with millions of particles and billions of photons, if not more.</p>
<p>If you want to be absolutely pedantic, we can distinguish the following cases:</p>
<ul>
<li>a single scattering event, where a photon meets a particle and is scattered away;</li>
<li>single scattering, where a photon is scattered <em>once</em> by a medium (a large collection of photons), which is under
<ul>
<li>a collimated illumination, so the radiance of a ray can only be weakened because photons are scattered to other directions,</li>
<li>an arbitrary illumination, so the radiance of a ray can be both weakened and augmented (by photons scattered from other directions);</li>
</ul></li>
<li>multiple scattering, where a photon is scattered <em>multiple times</em> by a medium, so the radiance of a ray can both be weakened and augmented.</li>
</ul>
<p><a href="#sec-chpt-mat-vs-sca-single" class="quarto-xref"><span>Section 15.2</span></a> studies Case 1 and Case 2(a) together, because the latter is the statistical consequence of the former. <a href="rendering-rte.html" class="quarto-xref"><span>Chapter 16</span></a> studies Case 2(b) and Case 3 together because they have the same observable effects and, thus, are modeled in the same way.</p>
</section>
<section id="interference-and-coherence" class="level3" data-number="15.1.2">
<h3 data-number="15.1.2" class="anchored" data-anchor-id="interference-and-coherence"><span class="header-section-number">15.1.2</span> Interference and Coherence</h3>
<p>Second, when there is a large collection of particles, the scattered radiation fields of individual particles can interfere with each other. The exact impact of interference can only be calculated by considering the wave nature of the light. But to the first order, the inference depends on how densely packed the particles are.</p>
<p>In fact, the specular surface scattering we discussed in <a href="rendering-surfacemodeling.html#sec-chpt-mat-ss-mat" class="quarto-xref"><span>Section 12.1</span></a> is just a macroscopic approximation of the microscopic volume scattering where particles interfere non-randomly. In a mirror or a glass of water, the particles/molecules are very densely packed to the point that the distance between two particles is smaller than the wavelength of the light. As a result, the scattering is <em>coherent</em>, which gives rise to the <em>illusion</em> of a specular surface. One can show that the Fresnel equations are the solution to the Maxwell’s equations when surface particles are densely packed.</p>
<p>Why would the particle density matter? If particles are very close to each other, their radiation fields are close too, so the interference is stronger and cannot be ignored. More importantly, when particles are close to each other, their spatial positions can no longer be treated as random, so the interference can become coherent. Imagine you drop particles into a vast empty space; the particle sizes are much smaller relative to the space, so their spatial distribution can be roughly described as random. But if the particles are very densely packed, where the next particle can be is very much restrained, so their positions are highly correlated, leading to coherent scattering.</p>
<p>We will generally assume <strong>incoherent scattering</strong> unless otherwise noted, where individual scattering events interfere each other in random ways, so we are spared of the complication of thinking of the wave nature of the photons. Under this assumption, the total power scattered by a collection of particles is the same as the sum of the power scattered by the individual particles. This happens when the particles are sufficient sufficiently distant (separated by more than multiple wavelengths) and their spatial arrangements are uncorrelated.</p>
<!-- %according to bohren and huffman p. 9, it's possible that particles are sufficiently apart but they are still not randomly positioned so their scattered fields can still interfere in a coherent way.
%when they say single scattering, they just mean particles are very apart, and their multiple scattering means particles are close.
%this definition is technically precise but can be weird since if particles are apart even if they interfere the effect is weak.
%so in our definition (and many others) here we assume that incoherent scattering means particles are both sufficiently apart and sufficiently randomly positioned so that individual scatterings are independent of each other. -->
</section>
</section>
<section id="sec-chpt-mat-vs-sca-single" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="sec-chpt-mat-vs-sca-single"><span class="header-section-number">15.2</span> A Single Scattering Event</h2>
<section id="sec-chpt-mat-vs-sca-single-coeff" class="level3" data-number="15.2.1">
<h3 data-number="15.2.1" class="anchored" data-anchor-id="sec-chpt-mat-vs-sca-single-coeff"><span class="header-section-number">15.2.1</span> Scattering Efficiency and Coefficient</h3>
<p>Intuitively, scattering has a similar effect as absorption: it weakens the radiance by taking photons away from a beam of light. The difference is that scattered photons are not dead; they are re-directed to other directions. We can define two important quantities, one to characterize a <em>particle</em>’s ability to scatter photons and the other to characterize a <em>medium</em>’s ability to scatter photons.</p>
<p>Similar to the situation in absorption, the intrinsic capability of a particle to scatter photons is defined by the particle’s <strong>scattering cross section</strong> <span class="math inline">\(\epsilon_s\)</span>, which itself is the product of the geometrical cross-sectional area of the particle <span class="math inline">\(\epsilon_g\)</span> and the <strong>scattering efficiency</strong> <span class="math inline">\(Q_s\)</span>. We can then define the <strong>scattering coefficient</strong> <span class="math inline">\(\sigma_s\)</span> of a medium (a large collection of particles), which characterizes the ability of the medium to scatter photons away from its incident radiance. <span class="math inline">\(\sigma_s\)</span> is the product of the particle concentration of the medium <span class="math inline">\(c\)</span> and the particle’s scattering cross section <span class="math inline">\(\epsilon_s\)</span>. Again, <span class="math inline">\(\sigma_s\)</span> has a unit <span class="math inline">\(\text{m}^\text{-1}\)</span> and is not bound by 0 and 1; it is best interpreted as the probability density (i.e., probability per unit length) of light being scattered away. Of course, both the scattering efficiency and scattering coefficient can vary spatially, angularly, and spectrally.</p>
<p>The effects of scattering and absorption add up, because they both weaken a radiance. We can extend <a href="rendering-absorption.html#eq-abs_cont" class="quarto-xref">Equation&nbsp;<span>14.13</span></a> to consider scattering (again omitting the wavelength from the equations):</p>
<p><span id="eq-scat_cont"><span class="math display">\[
\begin{align}
    L(p+s\omega, \omega) = L(p, \omega) e^{-\int_0^s (\sigma_a(p+t\omega, \omega) + \sigma_s(p+t\omega, \omega)) \d t},
\end{align}
\tag{15.1}\]</span></span></p>
<p>where <span class="math inline">\(\sigma_s(p, \omega)\)</span> is the scattering coefficient at <span class="math inline">\(p\)</span> toward the direction <span class="math inline">\(\omega\)</span>.</p>
<p>Rearranging the terms, we can express the <strong>transmittance</strong> between <span class="math inline">\(p\)</span> and <span class="math inline">\(p+s\omega\)</span> along the direction <span class="math inline">\(\omega\)</span>, denoted <span class="math inline">\(T(p \rightarrow p+s\omega)\)</span>: <span id="eq-transmittance"><span class="math display">\[
\begin{align}
    T(p \rightarrow p+s\omega) = \frac{L(p+s\omega, \omega)}{L(p, \omega)} = e^{-\int_0^s (\sigma_a(p+t\omega, \omega) + \sigma_s(p+t\omega, \omega)) \d t}.
\end{align}
\tag{15.2}\]</span></span></p>
<p><a href="#eq-scat_cont" class="quarto-xref">Equation&nbsp;<span>15.1</span></a> can be derived using the same idea as that used for deriving the absorption equation in <a href="rendering-absorption.html#sec-chpt-mat-vs-abs-simple" class="quarto-xref"><span>Section 14.1</span></a> by modeling a thin layer <span class="math inline">\(\D x\)</span> — with an additional assumption that <span class="math inline">\(\D x\)</span> is so thin that a photon is scattered at most once before leaving <span class="math inline">\(\D x\)</span>. Therefore, scattering by a single particle has the same effect as absorption: they both take the photon out of the radiance, and that is why the absorption equation (<a href="rendering-absorption.html#eq-abs_cont" class="quarto-xref">Equation&nbsp;<span>14.13</span></a>) can be directly extended here.</p>
<p>Think of the applicability of <a href="#eq-scat_cont" class="quarto-xref">Equation&nbsp;<span>15.1</span></a>: it says that the radiance of a ray can only be weakened. If the incident light has only one direction (e.g., a collimated beam), <a href="#eq-scat_cont" class="quarto-xref">Equation&nbsp;<span>15.1</span></a> is true when a photon is scattered at most once in the medium. This is because a scattered photon will not have a chance to get back to the ray. If the incident light is not mono-directional, e.g., diffuse illumination, <a href="#eq-scat_cont" class="quarto-xref">Equation&nbsp;<span>15.1</span></a> in general does not apply — even if we consider only single scattering. This is because photons originally not along the direction <span class="math inline">\(\omega\)</span> can be scattered toward it through just one single scattering event. We can see how limited <a href="#eq-scat_cont" class="quarto-xref">Equation&nbsp;<span>15.1</span></a> is: it applies only when the illumination is collimated and we assume only single scattering. We will relax this constraint later. <!-- %same as the text above Equ 3.108 in Bohren. --></p>
<p>Just like the absorption case (<a href="rendering-absorption.html#eq-absorbances_add" class="quarto-xref">Equation&nbsp;<span>14.11</span></a>), if a medium is mixed with different particles, each with a different scattering coefficient, the overall scattering coefficient is the sum of the individual scattering coefficients as if the medium is made up of a particular kind of particles.</p>
<p>The sum of the scattering coefficient and absorption coefficient is called the <strong>extinction coefficient</strong> or <strong>attenuation coefficient</strong>, denoted <span class="math inline">\(\sigma_t(p, \omega)\)</span>:</p>
<p><span class="math display">\[
\begin{align}
    \sigma_t(p, \omega) = \sigma_a(p, \omega) + \sigma_s(p, \omega).
\end{align}
\]</span></p>
<p>The ratio between the scattering coefficient and the attenuation coefficient is called the <strong>single-scattering albedo</strong> of the medium:</p>
<p><span class="math display">\[
\begin{align}
    \rho = \frac{\sigma_s(p, \omega)}{\sigma_t(p, \omega)}.
\end{align}
\]</span></p>
<p>This albedo can be seen as the volumetric counterpart of the surface albedo discussed in <a href="rendering-surfacescattering.html#eq-albedo_1" class="quarto-xref">Equation&nbsp;<span>11.11</span></a>. The two forms of albedo have the same physical meaning: the fraction of the incident energy that is scattered away (i.e., not absorbed). A dark medium (e.g., smoke) has a lower albedo, and a bright medium (e.g., mist) has a higher albedo.</p>
<p>The sum of the scattering and absorption cross sections is called the <strong>extinction cross section</strong> or <strong>attenuation cross section</strong>, denoted <span class="math inline">\(\epsilon_t = \epsilon_a + \epsilon_s\)</span>. And of course <span class="math inline">\(1/\sigma_t\)</span> is the mean free path in a medium where both absorption and scattering take place, i.e., the mean distance a photon can travel without being absorbed or scattered away.</p>
</section>
</section>
<section id="sec-chpt-mat-vs-sca-single-pf" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="sec-chpt-mat-vs-sca-single-pf"><span class="header-section-number">15.3</span> Scattering Direction Distribution: Phase Function</h2>
<p>While the scattering efficiency (coefficient) characterizes how well a particle (medium) is able to scatter photons, it tells us nothing about the <em>direction</em> of scattering. The direction of a single scattering event is characterized by the <strong>phase function</strong> <span class="math inline">\(f_p(p, \os, \oi)\)</span>, which can be interpreted as the probability <em>density</em> function that a photon incident from a direction <span class="math inline">\(\oi\)</span> is scattered toward a direction <span class="math inline">\(\os\)</span>. We will omit <span class="math inline">\(p\)</span> and write the phase function as <span class="math inline">\(f_p(\os, \oi)\)</span> when the discussion is unconcerned of <span class="math inline">\(p\)</span>.</p>
<p><span class="math inline">\(f_p(\os, \oi)\)</span> is defined as the fraction of the irradiance incident from an infinitesimal solid angle <span class="math inline">\(\doi\)</span> that is scattered toward an infinitesimal solid angle <span class="math inline">\(\dos\)</span> per unit solid angle:</p>
<p><span id="eq-phase_func_def"><span class="math display">\[
\begin{align}
    f_p(\os, \oi) = \lim_{\Dos \rightarrow 0} \lim_{\Doi \rightarrow 0} \frac{\D E_o(\os)}{\D E_i(\oi)} / \Dos = \frac{\d^2 E_o(\os)}{\d E_i(\oi)\dos} = \frac{\d^2 E_o(\os)}{L(\oi) \doi \dos}.
\end{align}
\tag{15.3}\]</span></span></p>
<p><span class="math inline">\(\D E_i(\oi)\)</span> is the incident irradiance over a small solid angle <span class="math inline">\(\Doi\)</span> and scatters in all directions. <span class="math inline">\(\D E_o(\oi)\)</span> is the outgoing irradiance over a small solid angle <span class="math inline">\(\Dos\)</span>, so <span class="math inline">\(\frac{\D E_o(\os)}{\D E_i(\oi)}\)</span> is the fraction of the photons incident from <span class="math inline">\(\Doi\)</span> that are scattered over <span class="math inline">\(\Dos\)</span> or, alternatively, the probability that a photon incident from <span class="math inline">\(\Doi\)</span> is scattered toward <span class="math inline">\(\Dos\)</span>; this ratio/fraction is clearly a value between 0 and 1. Dividing that fraction by <span class="math inline">\(\Dos\)</span> gets us the probability per unit solid angle. When both the incident solid angle <span class="math inline">\(\Doi\)</span> and the outgoing solid angle <span class="math inline">\(\Dos\)</span> approach 0, the fraction can be interpreted as the directional-directional reflectance (<a href="rendering-surfacescattering.html#sec-chpt-mat-ss-reflectance" class="quarto-xref"><span>Section 11.2</span></a>), and the probability per solid angle within <span class="math inline">\(\Dos\)</span> becomes the probability <em>density</em> toward <span class="math inline">\(\os\)</span>.</p>
<p>Like all density functions, the meaning of a phase function is most clear when it is integrated to compute some other quantity. Integrating <a href="#eq-phase_func_def" class="quarto-xref">Equation&nbsp;<span>15.3</span></a> over all the outgoing directions <span class="math inline">\(\os\)</span>:</p>
<p><span id="eq-energy_con_phase_func_1"><span class="math display">\[
\begin{align}
    \d E_o &amp;= \int^{\Omega = 4\pi} f_p(\os, \oi)L(\oi)\doi\dos \label{eq:energy_con_phase_func_1a} \\
    &amp;= L(\oi)\doi\int^{\Omega = 4\pi} f_p(\os, \oi)\dos \label{eq:energy_con_phase_func_1b} \\
    &amp;= \d E_i\int^{\Omega = 4\pi} f_p(\os, \oi)\dos \label{eq:energy_con_phase_func_1c}.
\end{align}
\tag{15.4}\]</span></span></p>
<p>To interpret this integration, consider a point that receives an incident radiance of <span class="math inline">\(L(\oi)\)</span> over an infinitesimal solid angle <span class="math inline">\(\doi\)</span>. The point receives a total irradiance of <span class="math inline">\(\d E_i = L(\oi)\doi\)</span>, which is scattered in all directions. The density of the irradiance scattered toward a particular direction <span class="math inline">\(\os\)</span> is <span class="math inline">\(f_p(\os, \oi)L(\oi)\doi\)</span><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, which when multiplied by <span class="math inline">\(\dos\)</span> gives us the actual irradiance scattered over a small solid angle <span class="math inline">\(\dos\)</span> around <span class="math inline">\(\os\)</span>. Integrating all outgoing directions over the entire sphere (<span class="math inline">\(4\pi\)</span>) we have <a href="#eq-energy_con_phase_func_1" class="quarto-xref">Equation&nbsp;<span>15.4</span></a>.</p>
<p>Now, of course, some of the photons in <span class="math inline">\(\d E_i\)</span> might not be scattered; they could be absorbed, or they could simply not hit the cross section of any particle. So technically <span class="math inline">\(\d E_o \leq \d E_i\)</span> in <a href="#eq-energy_con_phase_func_1" class="quarto-xref">Equation&nbsp;<span>15.4</span></a>, just like how energy conservation is expressed in surface scattering in <a href="rendering-surfacescattering.html#eq-energy_con_1" class="quarto-xref">Equation&nbsp;<span>11.8</span></a>. By the convention in the volume scattering literature, however, the phase function is defined such that <span class="math inline">\(\d E_i\)</span> refers to only the portion of the incident irradiance that does get scattered. Therefore, <span class="math inline">\(\d E_o = \d E_i\)</span>, so we have:</p>
<p><span id="eq-energy_con_phase_func_2"><span class="math display">\[
\begin{align}
    \int^{\Omega = 4\pi} f_p(\os, \oi) \dos = \int^{\Omega = 4\pi} f_p(\os, \oi) \doi = 1.
\end{align}
\tag{15.5}\]</span></span></p>
<p>That is, the phase function integrates to 1; the second integral can be derived using the Helmholtz reciprocity (since we are still dealing with geometrical optics):</p>
<p><span class="math display">\[
\begin{align}
    f_p(\oi, \os) = f_p(\os, \oi).
\end{align}
\]</span></p>
<p>One way to interpret the fact that the phase function integrates to 1 is that the phase function is the <em>conditional</em> probability density function of scattering: given that a photon is scattered, what is the probability (density) of scattering to a particular direction?</p>
<section id="phase-function-vs.-brdf" class="level3" data-number="15.3.1">
<h3 data-number="15.3.1" class="anchored" data-anchor-id="phase-function-vs.-brdf"><span class="header-section-number">15.3.1</span> Phase Function vs.&nbsp;BRDF</h3>
<p>The phase function can be seen as the volumetric counterpart (in the sense that we are talking about volume scattering) of BRDF (<a href="rendering-surfacescattering.html#sec-chpt-mat-ss-brdf" class="quarto-xref"><span>Section 11.1</span></a>) — with two differences. First, the definition of the BRDF accounts for absorption, so the BRDF integrates to <em>at most</em> 1, whereas the integral of the phase function is normalized to 1. This difference in definition is born purely of convention.</p>
<p>The second difference is more fundamental. There is no <span class="math inline">\(\cos\theta\)</span> term when using the phase function; see, e.g., <a href="#eq-energy_con_phase_func_1" class="quarto-xref">Equation&nbsp;<span>15.4</span></a>, unlike how the BRDF is used to turn irradiance into radiance (e.g., <a href="rendering-surfacescattering.html#eq-energy_con_1" class="quarto-xref">Equation&nbsp;<span>11.8</span></a>). In fact, from <a href="#eq-energy_con_phase_func_1" class="quarto-xref">Equation&nbsp;<span>15.4</span></a> we can see that given a radiance <span class="math inline">\(L(\oi)\)</span> and a solid angle <span class="math inline">\(\doi\)</span>, the irradiance is simply <span class="math inline">\(L(\oi)\doi\)</span> rather than <span class="math inline">\(L(\oi)\cos\theta_i\doi\)</span>. Didn’t we say that there is a cosine fall-off between radiance and irradiance (<a href="rendering-radiometry.html#sec-chpt-mat-basics-radiometry-radiance" class="quarto-xref"><span>Section 9.1.4</span></a>)?</p>
<p>One intuition that might help is that in volume scattering we are dealing with points, which can receive flux from the entire sphere and have no definition of a normal (because points are dimensionless and shapeless) or, perhaps more conveniently, have a “flexible” normal that changes with the illumination direction and is always facing directly at the illumination. Entertain this thought experiment. We set up a small surface detector at a point and measure the power of the detector; if the incident light is parallel to the surface, the detector would receive no power, but would you say that the <em>point</em> does not receive any light and that the radiation field has no power? Of course not.</p>
<p>The fact that a parallel surface would receive no photons absolutely does not mean the illumination has no power; the radiation field is the same whether it is illuminating a surface or illuminating a point. But if we are modeling a surface, we <em>want</em> our model to say that the power received by the surface is 0, because it matches our phenomenological observation (that a detector arranged that way would receive no recording); when we are modeling a point in volume scattering, we <em>want</em> the point to receive a power as if the point has a “normal” that is directly facing the illumination because, again, this matches our phenomenological observation.</p>
<p>Ultimately, the difference is a conscious choice of modeling strategy even though the underlying physics is exactly the same. That is why models based on BRDF and phase function are phenomenological models. If you deal with electromagnetic theories and QED, you would not have to have this distinction between modeling surface and volume scattering.</p>
<p>With the understanding that there is no cosine fall-off in volume scattering, <a href="#eq-phase_func_def" class="quarto-xref">Equation&nbsp;<span>15.3</span></a> can be re-written as:</p>
<p><span id="eq-phase_func_def2"><span class="math display">\[
\begin{align}
    f_p(\os, \oi) = \frac{\d^2 E_o(\os)}{\d E_i(\oi)\dos} = \frac{\d}{\d E_i(\oi)}\frac{\d E_o(\os)}{\dos} = \frac{\d L_o(\os)}{\d E_i(\oi)} = \frac{\d L_o(\os)}{L_i(\oi)\doi},
\end{align}
\tag{15.6}\]</span></span></p>
<p>where <span class="math inline">\(\d L_o(\os)\)</span> is the infinitesimal outgoing radiance toward <span class="math inline">\(\os\)</span>. In this sense, the phase function operates in exactly the same way as the BRDF (<a href="rendering-surfacemodeling.html#eq-brdf" class="quarto-xref">Equation&nbsp;<span>12.15</span></a>): they both operate on irradiance and turn infinitesimal irradiance into infinitesimal radiance.</p>
</section>
<section id="sec-chpt-mat-vs-sca-single-pf-iso" class="level3" data-number="15.3.2">
<h3 data-number="15.3.2" class="anchored" data-anchor-id="sec-chpt-mat-vs-sca-single-pf-iso"><span class="header-section-number">15.3.2</span> Isotropic Medium and Isotropic Scatters</h3>
<p>Given the normalization in the phase function, the scattering efficiency should actually be parameterized as <span class="math inline">\(\bar{Q_s}(p, \os, \oi)\)</span>:</p>
<p><span id="eq-sca_eff_phase"><span class="math display">\[
\begin{align}
    \bar{Q_s}(p, \os, \oi) = Q_s(p, \oi) f_p(p, \os, \oi),
\end{align}
\tag{15.7}\]</span></span></p>
<p>where <span class="math inline">\(Q_s(p, \oi)\)</span> should be be interpreted as the <em>total</em> scattering efficiency at <span class="math inline">\(p\)</span> over all outgoing directions for a given incident direction <span class="math inline">\(\oi\)</span>. Similarly, the scattering coefficient would be expressed as:</p>
<p><span id="eq-sca_coeff_phase"><span class="math display">\[
\begin{align}
    \bar{\sigma_s}(p, \os, \oi) = \sigma_s(p, \oi) f_p(p, \os, \oi),
\end{align}
\tag{15.8}\]</span></span></p>
<p>where <span class="math inline">\(\sigma_s(p, \oi)\)</span> is interpreted as the <em>total</em> scattering coefficient at <span class="math inline">\(p\)</span> over all outgoing directions for a given incident direction <span class="math inline">\(\oi\)</span>.</p>
<div id="fig-phase_function" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-phase_function-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figs/phase_function.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-phase_function-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.2: Visualizations of common phase functions; adapted from <span class="citation" data-cites="novak2018monte">Novák et al. (<a href="references.html#ref-novak2018monte" role="doc-biblioref">2018</a>)</span>, where <span class="math inline">\(\omega\)</span> and <span class="math inline">\(\bar\omega\)</span> are the incident direction <span class="math inline">\(\oi\)</span> and the outgoing direction <span class="math inline">\(\os\)</span> in our notation, respectively. For an isotropic medium, the phase function depends on only the angle <span class="math inline">\(\theta\)</span> subtended by <span class="math inline">\(\omega\)</span> and <span class="math inline">\(\omega'\)</span> and is axially symmetric about <span class="math inline">\(\omega\)</span>.
</figcaption>
</figure>
</div>
<p><a href="#fig-phase_function" class="quarto-xref">Figure&nbsp;<span>15.2</span></a> visualizes a few common phase functions. While <span class="math inline">\(f_p(\cdot)\)</span> is technically a 4D function parameterized by <span class="math inline">\(\os\)</span> and <span class="math inline">\(\oi\)</span>, the phase function of many natural media is 1D and depends only on the angle <span class="math inline">\(\theta\)</span> subtended by <span class="math inline">\(\os\)</span> and <span class="math inline">\(\oi\)</span>. In <a href="#fig-phase_function" class="quarto-xref">Figure&nbsp;<span>15.2</span></a>, the distance of a point on the contour to the center represents the magnitude of the phase function at that particular <span class="math inline">\(\theta\)</span> Consider under what conditions this simplification can be true:</p>
<ul>
<li>First, it says that the phase function does not depend on the absolute incident direction <span class="math inline">\(\oi\)</span> but the relative angle between <span class="math inline">\(\oi\)</span> and <span class="math inline">\(\os\)</span>. To get a visual intuition, see <a href="#fig-phase_function_isotropic" class="quarto-xref">Figure&nbsp;<span>15.3</span></a>; if the phase function is invariant to the photon incident direction <span class="math inline">\(\oi\)</span>, we can, without losing any generality, assign <span class="math inline">\(\oi\)</span> to the <span class="math inline">\(z\)</span>-axis; the scattered direction <span class="math inline">\(\os\)</span> is parameterized by <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\phi\)</span>.</li>
<li>Second, it also says the phase function depends on only <span class="math inline">\(\theta\)</span> but not <span class="math inline">\(\phi\)</span>. That is, the phase function is rotationally symmetric about the incident direction <span class="math inline">\(\oi\)</span>. So <span class="math inline">\(f_p(\os, \oi) = f_p(\os', \oi) \neq f_p(\os'', \oi)\)</span>.</li>
</ul>
<div id="fig-phase_function_isotropic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-phase_function_isotropic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figs/phase_function_isotropic.svg" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-phase_function_isotropic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.3: The phase function of a spherical particle is 1) invariant to the incident direction <span class="math inline">\(\oi\)</span>, which, without losing generality, is taken to be the <span class="math inline">\(z\)</span>-axis here, and 2) also invariant to the azimuthal angle <span class="math inline">\(\phi\)</span> of the outgoing direction <span class="math inline">\(\os\)</span> but depends on the polar angle <span class="math inline">\(\theta\)</span>. So <span class="math inline">\(f_p(\os, \oi) = f_p(\os', \oi) \neq f_p(\os'', \oi)\)</span>. Media consisting of such particles are called isotropic media, but it does not mean the particle itself is an isotropic scatterer, which does not exist, but if it did, its phase function would be a constant (invariant to both <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\phi\)</span>).
</figcaption>
</figure>
</div>
<p>Intuitively, the phase function has the following two properties:</p>
<ul>
<li>If you fix the incident direction, no matter how you rotate the particle, the phase function distribution is the same. Alternatively, if you change the incident direction, the phase function distribution moves along with the incident direction.</li>
<li>Given an incident direction, the phase function distribution is axially symmetric about the incident direction.</li>
</ul>
<p>The two conditions above are met only when the medium consists of randomly distributed spherically symmetric particles<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, in which case 1) there is no reason to think that any incident direction is special, so the phase function certainly is invariant to <span class="math inline">\(\oi\)</span>, and 2) there is no reason to think <span class="math inline">\(\os\)</span> and <span class="math inline">\(\os'\)</span> are any different since one should not expect the scattering behavior to change if we rotate the sphere about the incident direction (<span class="math inline">\(z\)</span>-axis).</p>
<p>A medium consisting of spherically symmetric particles is called a <em>symmetric</em> or an <strong>isotropic medium</strong>. Usually when we refer to an isotropic medium, not only is the phase function but also the total scattering coefficient <span class="math inline">\(\sigma_s(p, \oi)\)</span> (<a href="#eq-sca_coeff_phase" class="quarto-xref">Equation&nbsp;<span>15.8</span></a>) rotationally invariant to the incident direction<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p>
<p>As we said earlier, “isotropic” is an unbelievably overloaded term. People also call a particle an <strong>isotropic scatterer</strong> if its phase function is a constant, i.e., invariant to <span class="math inline">\(\os\)</span>; such a phase function is sometimes called an <em>isotropic phase function</em>. An isotropic scatterer does not exist; it is a purely theoretical construction, but if it existed, its phase function would take the value of <span class="math inline">\(\frac{1}{4\pi}\)</span> given <a href="#eq-energy_con_phase_func_2" class="quarto-xref">Equation&nbsp;<span>15.5</span></a>, as shown in the first graph in <a href="#fig-phase_function" class="quarto-xref">Figure&nbsp;<span>15.2</span></a>.</p>
</section>
</section>
<section id="sec-chpt-mat-vs-sca-models" class="level2" data-number="15.4">
<h2 data-number="15.4" class="anchored" data-anchor-id="sec-chpt-mat-vs-sca-models"><span class="header-section-number">15.4</span> Common Models and General “Rules”</h2>
<p>There are many factors that determine the exact scattering efficiency and scattering direction, which can be calculated by solving the Maxwell’s equations. We will talk about a few common models here; we focus on the intuitions while omitting the exact mathematical expressions, which can be found in standard texts. From the models, we can identify a few general “rules” or, rather, approximations under certain assumptions.</p>
<p>The main theory or model for a single scattering event is called the <strong>Mie scattering</strong> theory, which, strictly speaking, applies only when the particle is spherical <span class="citation" data-cites="sharma2003color bohren2006fundamentals melbourne2004radio">(<a href="references.html#ref-sharma2003color" role="doc-biblioref">Sharma 2003</a>, Chpt. 3.5.2; <a href="references.html#ref-bohren2006fundamentals" role="doc-biblioref">Bohren and Clothiaux 2006</a>, Chpt 3.5; <a href="references.html#ref-melbourne2004radio" role="doc-biblioref">Melbourne 2004</a>, Chpt. 3)</span>. Mie scattering is <em>not</em> somehow a different scattering process from any other scattering, and the Mie theory is nothing more than the solution to the Maxwell’s equations under certain conditions<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>.</p>
<p>The Mie theory predicts that the overall scattering efficiency <span class="math inline">\(Q_s\)</span> is:</p>
<p><span id="eq-mie_1"><span class="math display">\[
\begin{align}
    Q_s &amp;= \frac{8}{3}\gamma^4\big(\frac{m^2-1}{m^2+2}\big)\big[1+\frac{6}{5}\big(\frac{m^2-1}{m^2+2}\big)\gamma^2 + \cdots \big]\\
    \gamma &amp;= \frac{r}{\lambda_m}, \\
    m &amp;= \frac{n}{n_m},
\end{align}
\tag{15.9}\]</span></span></p>
<p>where <span class="math inline">\(m\)</span> is the the relative refractive index between the particle and the medium surrounding the particle, and <span class="math inline">\(\gamma\)</span> is the ratio between the particle radius <span class="math inline">\(r\)</span> and the incident light wavelength in the surrounding medium <span class="math inline">\(\lambda_m\)</span>. The notion of surrounding media might come across as a little surprising: doesn’t the material consist merely of its particles? Hardly. For instance, in paints, pigments are surrounded by binders (e.g., linseed oil in oil paints, egg yolk in tempera paints, and beeswax in encaustic paints) and usually some amount of water (except oil paints). When paint dries, some water might be evaporated, leaving pockets of air, which also contributes to the surrounding media.</p>
<p>We can draw a few general conclusions from the model.</p>
<section id="small-particle-rayleigh-scattering" class="level3" data-number="15.4.1">
<h3 data-number="15.4.1" class="anchored" data-anchor-id="small-particle-rayleigh-scattering"><span class="header-section-number">15.4.1</span> Small-Particle (Rayleigh) Scattering</h3>
<p>For small particles where <span class="math inline">\(\gamma \ll 1\)</span> (generally when the radius is ten times smaller than the wavelength of the incident light), only the first term in <a href="#eq-mie_1" class="quarto-xref">Equation&nbsp;<span>15.9</span></a>’s bracket matters, so the scattering efficiency is inversely proportional to <span class="math inline">\(\lambda_m^{-4}\)</span>. The inverse proportionality to <span class="math inline">\(\lambda_m^{-4}\)</span> <em>largely</em> (but apparently not entirely) explains why the sky is blue and why the sun is red <span class="citation" data-cites="bohren2006fundamentals">(<a href="references.html#ref-bohren2006fundamentals" role="doc-biblioref">Bohren and Clothiaux 2006</a>, Chpt. 8.1)</span>. Why? First, recognize that individual molecules, such as air molecules, are usually sub-nm in size, so they scatter in this small-particle regime. Short wavelength lights from the sun are scattered by the atmospheric molecules more toward the sky and eventually enter your eyes, so if you look at the sky (against the sun) it would appear blue; when you look at the sun directly, the photons entering your eyes are mostly those unscattered ones that transmit directly through the atmosphere, and they are mostly longer-wavelength photons.</p>
<p>By then water molecules are also similarly small, so why would water look so different from the air? It is because water molecules are very densely packed, so their scatterings are coherent. In fact, the end result of such coherent scatterings by a collection of water molecules is that water appears specular.</p>
<p>The photopigments in a photoreceptor are very small in size compared to the wavelengths of visible light (each rhodopsin has a cross-section area of about <span class="citation" data-cites="milo2015cell">(<a href="references.html#ref-milo2015cell" role="doc-biblioref">Milo and Phillips 2015, p. 144</a>)</span>), so they almost do not scatter lights at all, only absorption. That is why we could use microspectrophotometry (MSP) to measure a photoreceptor’s (transverse) absorption rate (<a href="hvs-receptor.html#sec-chpt-hvs-receptor-absorb-msp" class="quarto-xref"><span>Section 3.2.1</span></a>): MSP measures the amount of light transmitted through a photoreceptor, and if there is little scattering, then all the photons that are not measured must be absorbed by the photoreceptor.</p>
<p>Scattering in the small-particle regime is also called <strong>Rayleigh scattering</strong>, which, again, is <em>not</em> somehow a fundamentally different scattering process, and the Rayleigh scattering theory<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> is nothing more than a special case of the Mie scattering theory <span class="citation" data-cites="sharma2003color bohren2006fundamentals">(<a href="references.html#ref-sharma2003color" role="doc-biblioref">Sharma 2003</a>, Chpt. 3.5.1; <a href="references.html#ref-bohren2006fundamentals" role="doc-biblioref">Bohren and Clothiaux 2006</a>. Chpt. 3.2)</span>.</p>
<p>The phase function in the Rayleigh regime is proportional to <span class="math inline">\(1+\cos^2\theta\)</span>, so the backward and forward scatterings are roughly equally probable. Taking the phase function into account, the scattering efficiency (in the form defined in <a href="#eq-sca_eff_phase" class="quarto-xref">Equation&nbsp;<span>15.7</span></a>) in Rayleigh scattering is proportional to:</p>
<p><span class="math display">\[
\begin{align}
    Q_s \propto (\frac{r}{\lambda_m})^4 \frac{m^2-1}{m^2+2} (1 + \cos^2\theta).
\end{align}
\]</span></p>
</section>
<section id="impact-of-particle-size" class="level3" data-number="15.4.2">
<h3 data-number="15.4.2" class="anchored" data-anchor-id="impact-of-particle-size"><span class="header-section-number">15.4.2</span> Impact of Particle Size</h3>
<p>When the particle size increases, the scattering efficiency increases, initially very quickly, but eventually saturates. In fact, the Mie theory predicts that when the particle size is much larger than the wavelength (e.g., more than 100 times larger), the scattering efficiency approaches a constant 2 regardless of <span class="math inline">\(m\)</span> and <span class="math inline">\(\lambda_m\)</span> <span class="citation" data-cites="johnsen2012optics">(<a href="references.html#ref-johnsen2012optics" role="doc-biblioref">Johnsen 2012, fig. 5.4</a>)</span>. This is evident in <a href="#fig-scattering_efficiency_m" class="quarto-xref">Figure&nbsp;<span>15.4</span></a>, which shows the scattering efficiency of a kind of particle as a function of particle radius (<span class="math inline">\(x\)</span>-axis) under different <span class="math inline">\(m\)</span> (different curves); the incident light wavelength is 500 nm.</p>
<div id="fig-scattering_efficiency_m" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scattering_efficiency_m-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figs/scattering_efficiency_m.svg" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scattering_efficiency_m-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15.4: Scattering efficiency as a function of particle radius under different relative refractive index <span class="math inline">\(m\)</span>; the incident light wavelength is 500~nm. From <span class="citation" data-cites="johnsen2012optics">Johnsen (<a href="references.html#ref-johnsen2012optics" role="doc-biblioref">2012, fig. 5.4</a>)</span>.
</figcaption>
</figure>
</div>
<p>The particle size also affects the phase function. As we have discussed above, small particles in the Rayleigh regime tend to scatter photons equally in the forward and backward directions, while large particles primarily scatter photons in the forward directions. The last two graphs in <a href="#fig-phase_function" class="quarto-xref">Figure&nbsp;<span>15.2</span></a> show the phase functions predicted by the Mie scattering theory under different particle sizes (both are larger than that in the Rayleigh regime). The forward fraction increases as the particle size increases.</p>
<p>Consider the scenario in <a href="rendering-sss.html#fig-photon_particle_interactions" class="quarto-xref">Figure&nbsp;<span>13.1</span></a>, where Material<sub>1</sub> sits on top of Material<sub>2</sub>, and our goal is to hide Material 2 so that the color of Material 1 is dependent only on the illumination (not the property of Material 2). There is an interesting trade-off between scattering efficiency and scattering direction here. If we want Material 1 to hide Material 2, we want the particles in Material 1 to scatter a lot of light (high scattering efficiency) backwards. If the scattering efficiency is low (so photons march on and are hindered only by absorption) or the scattering is heavy in the forward directions, photons penetrate through Material 1 and reach Material 2, which would then contribute to the overall color.</p>
<p>Now, to scatter a lot of light, we need the particles to be large, but then the scattering will be mostly in the forward directions. So there exists a sweet spot of the particle size that provides the highest “hiding power” for a material per unit volume. If we work out the math, we will see that the sweet spot falls roughly in the visible wavelength range. That is why most paint pigments have a diameter between 100 nm and <span class="citation" data-cites="paintpigmentsize">(<a href="references.html#ref-paintpigmentsize" role="doc-biblioref">Bruce MacEvoy 2015</a>)</span>. Of course, no matter how poor the hiding power is for a particular paint, if you apply enough of it, it will eventually hide whatever is behind it. Dye pigments are rather small in size (nm range), so they scatter few photons and that is why dye solutions look relatively transparent.</p>
</section>
<section id="impact-of-refractive-index" class="level3" data-number="15.4.3">
<h3 data-number="15.4.3" class="anchored" data-anchor-id="impact-of-refractive-index"><span class="header-section-number">15.4.3</span> Impact of Refractive Index</h3>
<p><a href="#fig-scattering_efficiency_m" class="quarto-xref">Figure&nbsp;<span>15.4</span></a> also shows the impact of the relative refractive index <span class="math inline">\(m\)</span> (between the particle and the surrounding media) on scattering efficiency. Generally, the scattering efficiency increases with <span class="math inline">\(m\)</span> at all particle sizes until when the particles are so large that the scattering efficiency becomes a constant. This is supported by <a href="#eq-mie_1" class="quarto-xref">Equation&nbsp;<span>15.9</span></a>, too (<span class="math inline">\(\frac{m^2-1}{m^2+2}\)</span> monotonically increases and has a limit of 1).</p>
<p>For large particles, while <span class="math inline">\(m\)</span> does not affect the scattering efficiency, it influences the scattering directions. When <span class="math inline">\(m\)</span> is small, the scattering tends to be more forward, whereas when <span class="math inline">\(m\)</span> is large, the scattering tends to be toward large angles (i.e., more photons will be back-scattered). This is why wet objects look darker (recall the unpleasant experience of accidentally spilling water on your pants). In dry paints, the medium surrounding the textile particles is air, and in wet paints it is water. <span class="math inline">\(m\)</span> becomes smaller when the material is wet (i.e., the relative refractive-index difference becomes smaller between the textile particles and water), so most of the scattering will be forward, increasing the traversal length of photons and essentially giving photons more opportunities to be absorbed.</p>
</section>
<section id="aspherical-particles" class="level3" data-number="15.4.4">
<h3 data-number="15.4.4" class="anchored" data-anchor-id="aspherical-particles"><span class="header-section-number">15.4.4</span> Aspherical Particles</h3>
<p>What if the particle is not spherical? The Mie theory does not apply. Analytical or even numerical solutions to the Maxwell’s equations would be difficult, so perhaps a better approach is just to parameterize a model and fit it with the experimental data.</p>
<p>One popular one-parameter parameterization of the phase function is the <strong>Henyey–Greenstein</strong> phase function <span class="citation" data-cites="pharr2018physically bohren2006fundamentals">(<a href="references.html#ref-pharr2018physically" role="doc-biblioref">Pharr, Jakob, and Humphreys 2018</a>, Chpt. 11.3.1; <a href="references.html#ref-bohren2006fundamentals" role="doc-biblioref">Bohren and Clothiaux 2006</a>, Chpt. 6.3.2)</span>, which takes the form:</p>
<p><span class="math display">\[
\begin{align}
    p(\theta) = \frac{1}{4\pi} \frac{1-g^2}{(1+g^2-2g\cos\theta)^{3/2}},
\end{align}
\]</span></p>
<p>where <span class="math inline">\(g\)</span> is the free parameter and is usually called the <strong>asymmetry parameter</strong>.</p>
<p>We hasten to emphasize that the Henyey–Greenstein function has absolutely zero physical meaning; it is designed for fitting experimental phase function data, so in the modern deep learning era, you might as well try a deep neural network. The second graph in <a href="#fig-phase_function" class="quarto-xref">Figure&nbsp;<span>15.2</span></a> shows one instantiation of the Henyey–Greenstein function.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-bohren2006fundamentals" class="csl-entry" role="listitem">
Bohren, Craig F, and Eugene E Clothiaux. 2006. <em>Fundamentals of Atmospheric Radiation: An Introduction with 400 Problems</em>. John Wiley &amp; Sons.
</div>
<div id="ref-paintpigmentsize" class="csl-entry" role="listitem">
Bruce MacEvoy. 2015. <span>“<span class="nocase">The material attributes of paints</span>.”</span> <a href="https://www.handprint.com/HP/WCL/pigmt3.html#particlesize" class="uri">https://www.handprint.com/HP/WCL/pigmt3.html#particlesize</a>.
</div>
<div id="ref-johnsen2012optics" class="csl-entry" role="listitem">
Johnsen, Sönke. 2012. <em>The Optics of Life: A Biologist’s Guide to Light in Nature</em>. Princeton University Press.
</div>
<div id="ref-melbourne2004radio" class="csl-entry" role="listitem">
Melbourne, William G. 2004. <em>Radio Occultations Using Earth Satellites: A Wave Theory Treatment</em>. 1st ed. John Wiley &amp; Sons.
</div>
<div id="ref-milo2015cell" class="csl-entry" role="listitem">
Milo, Ron, and Rob Phillips. 2015. <em>Cell Biology by the Numbers</em>. Garland Science.
</div>
<div id="ref-novak2018monte" class="csl-entry" role="listitem">
Novák, Jan, Iliyan Georgiev, Johannes Hanika, Jaroslav Křivánek, and Wojciech Jarosz. 2018. <span>“<span>Monte</span> <span>Carlo</span> Methods for Physically Based Volume Rendering.”</span> In <em>ACM SIGGRAPH 2018 Courses</em>.
</div>
<div id="ref-pharr2018physically" class="csl-entry" role="listitem">
Pharr, Matt, Wenzel Jakob, and Greg Humphreys. 2018. <em>Physically Based Rendering: From Theory to Implementation</em>. 3rd ed. MIT Press.
</div>
<div id="ref-sharma2003color" class="csl-entry" role="listitem">
Sharma, Gaurav. 2003. <span>“Color Fundamentals for Digital Imaging.”</span> In <em>Digital Color Imaging Handbook</em>, edited by Gaurav Sharma, 14–127. CRC Press.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Technically photons from other objects can enter our eye through a single-scattering event; see the discussion at the end.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>A direction <span class="math inline">\(\os\)</span> has a solid angle of 0, so its associated irradiance is technically 0, too. What <span class="math inline">\(f_p(\os, \oi)L(\oi)\doi\)</span> represents is the irradiance per solid angle.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>or when the medium consists of randomly distributed and oriented spherically asymmetric particles, in which case the medium is <em>statistically</em> spherically symmetric.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>In theory, it is certainly possible to have a medium whose total scattering coefficient/efficiency varies with the incident direction but not the angular distribution/probability of the scattered photons.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>The modern form of the solution is summarized, not invented, by Gustav Mie but the solution had been developed by many predecessors such as Ludvig Lorenz.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>worked out by Lord Rayleigh, who won the Nobel Prize in Physics in 1904<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./rendering-absorption.html" class="pagination-link" aria-label="Absorption">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Absorption</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./rendering-rte.html" class="pagination-link" aria-label="Radiative Transfer Equation and Volume Rendering">
        <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Radiative Transfer Equation and Volume Rendering</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>