<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>14&nbsp; Absorption – Foundations of Visual Computing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./rendering-scattering.html" rel="next">
<link href="./rendering-sss.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-485d01fc63b59abcd3ee1bf1e8e2748d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./rendering.html">Rendering</a></li><li class="breadcrumb-item"><a href="./rendering-absorption.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Absorption</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Foundations of Visual Computing</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">An Invitation to Visual Computing</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./hvs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Human Visual System</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hvs-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">From Light to Vision</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hvs-receptor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Photoreceptors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hvs-color.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Color Vision</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hvs-colorimetry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Colorimetry</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hvs-retcomp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Models for Retinal Computation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hvs-adaptation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Visual Adaptations and Constancy</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./rendering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rendering</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Overview</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-radiometry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Radiometry and Photometry</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-lightfield.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Light Field</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-surfacescattering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">The Rendering Equation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-surfacemodeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Modeling Material Surface</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-sss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Subsurface and Volume Scattering</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-absorption.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Absorption</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-scattering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Scattering</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rendering-rte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Radiative Transfer Equation and Volume Rendering</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./imaging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Imaging</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./imaging-optics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Imaging Optics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./imaging-sensor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Image Sensor Architecture</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./imaging-noises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Noises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./imaging-isp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Image Signal Processing</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./display.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Display</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./display-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Basic Principles</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./display-impl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Implementation Technologies</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-chpt-mat-vs-abs-simple" id="toc-sec-chpt-mat-vs-abs-simple" class="nav-link active" data-scroll-target="#sec-chpt-mat-vs-abs-simple"><span class="header-section-number">14.1</span> A Simple Case: Collimated Illumination on Uniform Medium</a>
  <ul class="collapse">
  <li><a href="#bouguer-beer-lamberts-law" id="toc-bouguer-beer-lamberts-law" class="nav-link" data-scroll-target="#bouguer-beer-lamberts-law"><span class="header-section-number">14.1.1</span> Bouguer-Beer-Lambert’s Law</a></li>
  <li><a href="#an-alternative-derivation" id="toc-an-alternative-derivation" class="nav-link" data-scroll-target="#an-alternative-derivation"><span class="header-section-number">14.1.2</span> An Alternative Derivation</a></li>
  </ul></li>
  <li><a href="#absorption-coefficient" id="toc-absorption-coefficient" class="nav-link" data-scroll-target="#absorption-coefficient"><span class="header-section-number">14.2</span> Absorption Coefficient</a></li>
  <li><a href="#sec-chpt-mat-vs-abs-quan" id="toc-sec-chpt-mat-vs-abs-quan" class="nav-link" data-scroll-target="#sec-chpt-mat-vs-abs-quan"><span class="header-section-number">14.3</span> A Few Important Quantities</a></li>
  <li><a href="#general-case" id="toc-general-case" class="nav-link" data-scroll-target="#general-case"><span class="header-section-number">14.4</span> General Case</a></li>
  <li><a href="#nature-and-applicability-of-the-model" id="toc-nature-and-applicability-of-the-model" class="nav-link" data-scroll-target="#nature-and-applicability-of-the-model"><span class="header-section-number">14.5</span> Nature and Applicability of the Model</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./rendering.html">Rendering</a></li><li class="breadcrumb-item"><a href="./rendering-absorption.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Absorption</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-chpt-mat-vs-abs" class="quarto-section-identifier"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Absorption</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="hidden">
<p><span class="math display">\[
\def\oi{{\omega_i}}
\def\os{{\omega_s}}
\def\Oi{{\Omega_i}}
\def\Os{{\Omega_s}}
\def\d{{\text{d}}}
\def\D{{\Delta}}
\def\do{{\d\omega}}
\def\Do{{\Delta\omega}}
\def\doi{{\d\omega_i}}
\def\dos{{\d\omega_s}}
\def\Doi{{\D\omega_i}}
\def\Dos{{\D\omega_s}}
\def\H{{\mathbf{H}}}
\newcommand{\cM}{\mathcal{M}}
\newcommand{\cL}{\mathcal{L}}
\]</span></p>
</div>
<p>We will focus on modeling absorption in this chapter, and the way we build the models is fundamental to how scattering will be dealt with later.</p>
<section id="sec-chpt-mat-vs-abs-simple" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="sec-chpt-mat-vs-abs-simple"><span class="header-section-number">14.1</span> A Simple Case: Collimated Illumination on Uniform Medium</h2>
<p>Imagine that a beam of light hits a volume of particles. The light is <strong>collimated</strong> in that all photons travel along the same direction. We take a slice of the material perpendicular to the incident direction. The slice is so thin that no particles in that material cover each other from the direction of the incident light. This is shown in <a href="#fig-absorption_model" class="quarto-xref">Figure&nbsp;<span>14.1</span></a> (a). We also, for now, assume that the medium is <em>uniform</em> in that the <strong>number concentration</strong> <span class="math inline">\(c\)</span> (i.e., the number of particles per unit volume) of each slice is exactly the same.</p>
<div id="fig-absorption_model" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-absorption_model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figs/absorption_model.svg" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-absorption_model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14.1: Conceptual model to help reason about photon absorption. (a): the setting for calculating the radiance reduction over a very thin slice. (b): the radiance reduction over a finite length is calculated by accumulating the radiance reduction over infinitely many thin slices.
</figcaption>
</figure>
</div>
<p>Say the slice has a depth of <span class="math inline">\(\D s\)</span> and a geometrical cross-sectional area of <span class="math inline">\(E\)</span>. All the particles have the same geometrical cross-sectional area of <span class="math inline">\(\epsilon_g\)</span>. In the simplest model, a photon is absorbed whenever it hits a particle. In reality, the chance of absorption can be higher or lower. The <em>effective</em> area available for absorption is:</p>
<p><span class="math display">\[
\begin{align}
    \epsilon = \epsilon_g Q_a,
\end{align}
\]</span></p>
<p>where <span class="math inline">\(Q_a\)</span> is called the <strong>absorption efficiency</strong> and is usually smaller than 1 for molecules (which have small <span class="math inline">\(\epsilon_g\)</span>) and greater than 1 for large particles (whose <span class="math inline">\(\epsilon_g\)</span> can be large). <span class="math inline">\(Q_a\)</span> is wavelength dependent, so we should have written it as <span class="math inline">\(Q_a(\lambda)\)</span>, but we will omit the wavelength in our notations for simplicity’s sake. In physics, <span class="math inline">\(\epsilon\)</span> is called the <strong>absorption cross section</strong> of the particle; it characterizes the intrinsic capability of a particle to absorb photons. Mind the subtle but important difference between the geometrical cross-sectional area and the cross section of a particle.</p>
<p>The question we are interested in is, if the incident radiance is <span class="math inline">\(L\)</span>, what is the radiance leaving the slice <span class="math inline">\(L+\D L\)</span>? By convention, <span class="math inline">\(\D L\)</span> is defined as the exitant radiance minus the incident radiance and, in this case, has to be negative. The percentage of photons that are absorbed by this slice of particles (<span class="math inline">\(-\frac{\D L}{L}\)</span>) is equivalent to the cross-sectional area of the slice that is covered by the total cross sections of the particles:</p>
<p><span id="eq-abs_1"><span class="math display">\[
\begin{align}
    -\frac{\D L}{L} &amp;= \frac{cE\D s\epsilon}{E},
\end{align}
\tag{14.1}\]</span></span></p>
<p>where <span class="math inline">\(c\)</span> is the particle concentration of the slice, and <span class="math inline">\(E\D s\)</span> is the total volume of the slice. So <span class="math inline">\(cE\D s\)</span> is the number of particles in this thin slice, and <span class="math inline">\(cE\D s\epsilon\)</span> is the total cross section of all the particles. Given the assumption that no particles are covering each other, <span class="math inline">\(\frac{cE\D l\epsilon}{E}\)</span> is then the percentage of the thin slice’s cross-sectional area that is available for photon absorption and, thus, the percentage of the incident photons that are absorbed. The negative sign on the left-hand side of <a href="#eq-abs_1" class="quarto-xref">Equation&nbsp;<span>14.1</span></a> signals the fact that <span class="math inline">\(\D L\)</span> is negative.</p>
<p>We rewrite <a href="#eq-abs_1" class="quarto-xref">Equation&nbsp;<span>14.1</span></a> as <a href="#eq-abs_2" class="quarto-xref">Equation&nbsp;<span>14.2</span></a>: <span id="eq-abs_2"><span class="math display">\[
\begin{align}
    \frac{\D L}{\D s} &amp;= -c\epsilon L = -\sigma_a L,
\end{align}
\tag{14.2}\]</span></span></p>
<p>which shows that the amount of photon absorption per unit length (<span class="math inline">\(\frac{\D L}{\D s}\)</span>) is proportional to the current amount of photons up to a scaling factor <span class="math inline">\(c\epsilon\)</span>. In the computer graphics literature, <span class="math inline">\(c\epsilon\)</span> is called the <strong>absorption coefficient</strong>, denoted <span class="math inline">\(\sigma_a\)</span>.</p>
<section id="bouguer-beer-lamberts-law" class="level3" data-number="14.1.1">
<h3 data-number="14.1.1" class="anchored" data-anchor-id="bouguer-beer-lamberts-law"><span class="header-section-number">14.1.1</span> Bouguer-Beer-Lambert’s Law</h3>
<p>When <span class="math inline">\(\D s\)</span> approaches infinity, we can rewrite <a href="#eq-abs_2" class="quarto-xref">Equation&nbsp;<span>14.2</span></a> as a differential equation:</p>
<p><span id="eq-abs_3"><span class="math display">\[
\begin{align}
    \frac{\d L}{\d s} = \lim_{\D s \rightarrow 0}\frac{\D L}{\D s} = -\sigma_a L
\end{align}
\tag{14.3}\]</span></span></p>
<p>This equation is a classic case of exponential decay, and its solution is given by:</p>
<p><span id="eq-abs_4"><span class="math display">\[
\begin{align}
    L(s) = L_0 e^{-\sigma_a s}.
\end{align}
\tag{14.4}\]</span></span></p>
<p>where <span class="math inline">\(L_0 = L(0)\)</span> is the initial radiance of the light before interacting with the particles, as visualized in <a href="#fig-absorption_model" class="quarto-xref">Figure&nbsp;<span>14.1</span></a> (b), <span class="math inline">\(L(s)\)</span> denotes the radiance at a particular length <span class="math inline">\(s\)</span>.</p>
<p><a href="#eq-abs_4" class="quarto-xref">Equation&nbsp;<span>14.4</span></a> allows us to calculate the remaining radiance after the light travels a length <span class="math inline">\(s\)</span>. <a href="#eq-abs_4" class="quarto-xref">Equation&nbsp;<span>14.4</span></a> is called the <strong>Bouguer-Beer-Lambert’s law</strong> (BBL), which is a geometrical optics’ simplification of the electromagnetic theory of light-matter interaction where the matter is purely absorptive <span class="citation" data-cites="mayerhofer2020bouguer">(<a href="references.html#ref-mayerhofer2020bouguer" role="doc-biblioref">Mayerhöfer, Pahlow, and Popp 2020</a>)</span>.</p>
</section>
<section id="an-alternative-derivation" class="level3" data-number="14.1.2">
<h3 data-number="14.1.2" class="anchored" data-anchor-id="an-alternative-derivation"><span class="header-section-number">14.1.2</span> An Alternative Derivation</h3>
<p>An equivalent way of deriving the BBL law is the following. We divide the entire volume (with a total length of <span class="math inline">\(s\)</span>) into <span class="math inline">\(N\)</span> thin slices, each with a length of <span class="math inline">\(\D s\)</span>. After the first slice, the surviving portion of the initial radiance is <span class="math inline">\(L = L_0(1-\sigma_a \D s)\)</span>, so after going through all the <span class="math inline">\(N\)</span> slices, the remaining radiance is given by:</p>
<p><span id="eq-alt_abs_1"><span class="math display">\[
\begin{align}
    L_N = L_0(1-\sigma_a \D s)^N = L_0(1-\sigma_a \frac{s}{N})^N.
\end{align}
\tag{14.5}\]</span></span></p>
<p>Now when <span class="math inline">\(\D s\)</span> becomes infinitesimally small, <span class="math inline">\(N\)</span> approaches infinity, so the limit of the remaining radiance as a function of the total length <span class="math inline">\(s\)</span> is given in <a href="#eq-alt_abs_2" class="quarto-xref">Equation&nbsp;<span>14.6</span></a>, which is the same as <a href="#eq-abs_4" class="quarto-xref">Equation&nbsp;<span>14.4</span></a>.</p>
<p><span id="eq-alt_abs_2"><span class="math display">\[
\begin{align}
    L(s) = \lim_{N \rightarrow \infty}L_0(1-\sigma_a \frac{s}{N})^N = L_0 e^{-\sigma_a s}.
\end{align}
\tag{14.6}\]</span></span></p>
</section>
</section>
<section id="absorption-coefficient" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="absorption-coefficient"><span class="header-section-number">14.2</span> Absorption Coefficient</h2>
<p>The absorption coefficient is an important measure of the medium’s ability to absorb photons. It has a unit of <span class="math inline">\(\text{m}^\text{-1}\)</span>, which means it is not bound by 0 and 1. One way to interpret the absorption coefficient is to observe that <span class="math inline">\(\sigma_a \d s = \d L/L\)</span>, which is the fraction of the radiance absorbed or the probability of light absorption by an infinitesimal slice. So <span class="math inline">\(\sigma_a = (\d L/L)/\d s\)</span> can be interpreted as the probability <em>density</em> of photon absorption, i.e., the probability of absorption per unit length traveled:</p>
<p><span class="math display">\[
\begin{align}
    \sigma_a = \lim_{\D s \rightarrow 0} \frac{\D L}{L}/\D s = \frac{\d L}{L \d s}.
\end{align}
\]</span></p>
<p>Like any density measure, absorption coefficient is most useful when it is integrated: when we integrate <span class="math inline">\(\sigma_a\)</span> over the length that light travels, we get the fraction/percentage of the light absorbed. One can also show that <span class="math inline">\(1/\sigma_a\)</span> is the expected value of the distance a photon can travel before being absorbed <span class="citation" data-cites="bohren2006fundamentals">(<a href="references.html#ref-bohren2006fundamentals" role="doc-biblioref">Bohren and Clothiaux 2006</a>, Chpt. 5.1.3)</span>; this quantity is given the name <strong>mean free path</strong> (l). To derive <span class="math inline">\(l\)</span>, observe that the probability that a photon is absorbed after traveling a distance <span class="math inline">\(s\)</span> is <span class="math inline">\(1-e^{-\sigma_as}\)</span>. So the probability <em>density</em> of absorption as a function of the distance <span class="math inline">\(s\)</span> is:</p>
<p><span class="math display">\[
\begin{align}
    f(s) = \frac{\text{d}(1-e^{-\sigma_a s})}{\text{d}s} = \sigma_ae^{-\sigma_a s}.
\end{align}
\]</span></p>
<p>So the expected value of <span class="math inline">\(s\)</span>, which we can interpret as the distance a photon can travel on average before being absorbed, is:</p>
<p><span id="eq-mfp"><span class="math display">\[
\begin{align}
    l = \int_0^\infty sf(s)\text{d}s = 1/\sigma_a.
\end{align}
\tag{14.7}\]</span></span></p>
</section>
<section id="sec-chpt-mat-vs-abs-quan" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="sec-chpt-mat-vs-abs-quan"><span class="header-section-number">14.3</span> A Few Important Quantities</h2>
<p>We can now define a few other commonly used quantities (omitting the wavelength dependence for simplicity). The <strong>transmittance</strong> <span class="math inline">\(T\)</span> of a volume with a total thickness of <span class="math inline">\(s\)</span> is defined as the percentage of the transmitted/unabsorbed photons after traveling the length of <span class="math inline">\(s\)</span> (<a href="#eq-trans" class="quarto-xref">Equation&nbsp;<span>14.8</span></a>): <span id="eq-trans"><span class="math display">\[
\begin{align}
    T = \frac{L(s)}{L_0} = e^{-\sigma_a s}.
\end{align}
\tag{14.8}\]</span></span></p>
<p>The <strong>absorbance</strong> <span class="math inline">\(A\)</span> is the product of <span class="math inline">\(\sigma_a s\)</span>: <span id="eq-absorbance"><span class="math display">\[
\begin{align}
    A = -\ln T = \ln\frac{L(s)}{L_0} = \sigma_a s.
\end{align}
\tag{14.9}\]</span></span></p>
<p>The <strong>absorptance</strong> <span class="math inline">\(a\)</span> of a volume is defined as the percentage of the absorbed photons by the volume, which relates to <span class="math inline">\(T\)</span> and <span class="math inline">\(A\)</span> by <a href="#eq-absorbance" class="quarto-xref">Equation&nbsp;<span>14.9</span></a>: <span id="eq-absorptance"><span class="math display">\[
\begin{align}
    a = 1 - T = 1 - e^{-A}.
\end{align}
\tag{14.10}\]</span></span></p>
<p>We have seen these definitions in <a href="hvs-receptor.html#sec-chpt-hvs-receptor-absorb-msp" class="quarto-xref"><span>Section 3.2.1</span></a>. One very nice thing about the absorbance <span class="math inline">\(A\)</span> is that it is approximately equivalent to absorptance <span class="math inline">\(a\)</span> when <span class="math inline">\(A\)</span> is small (which would be true when, e.g., the length <span class="math inline">\(s\)</span> is very small, as is the case when discussing how a photoreceptor absorbs photons when illuminated transversely).</p>
<p>Another nice thing about absorbance is that absorbances add, because <em>absorption coefficients add</em>. Imagine you have <span class="math inline">\(n\)</span> kinds of particles mixed up in a medium, each with a different absorption coefficient <span class="math inline">\(\sigma_a^i\)</span>. The overall absorbance of the medium is the sum of the individual absorbance <span class="math inline">\(A^i\)</span> derived as if the medium is made up of only one kind of particles. That is: <span id="eq-absorbances_add"><span class="math display">\[
\begin{align}
    A = \sum_i^n A^i = s\sum_i^n\sigma_a^i = s\sum_i^n c^i\epsilon^i,
\end{align}
\tag{14.11}\]</span></span></p>
<p>where <span class="math inline">\(c^i\)</span> and <span class="math inline">\(\epsilon^i\)</span> are the concentration and absorption cross section of the <span class="math inline">\(i^{th}\)</span> particles. Specifically, <span class="math inline">\(c^i\)</span> is defined as: <span class="math display">\[
\begin{align}
    c^i = \frac{n_i}{V},
\end{align}
\]</span></p>
<p>where <span class="math inline">\(n_i\)</span> is the number of the <span class="math inline">\(i^{th}\)</span> kind of particles in the material, and <span class="math inline">\(V\)</span> is the material volume.</p>
<p>This is not a surprising result. As long as particles in a thin slice of this new heterogeneous medium do not cover each other, we can easily extend <a href="#eq-abs_1" class="quarto-xref">Equation&nbsp;<span>14.1</span></a> and the rest of the derivation to consider multiple kinds of particles; eventually <a href="#eq-absorbances_add" class="quarto-xref">Equation&nbsp;<span>14.11</span></a> would be a natural conclusion. We will omit the derivation here for simplicity sake.</p>
<p><a href="#eq-absorbances_add" class="quarto-xref">Equation&nbsp;<span>14.11</span></a> is a nice conclusion to have, because usually we <em>are</em> dealing with hybrid media. For instance, paint is a mixture of binder particles and pigment particles, and a mist is a mixture of water droplets and air particles. <!-- %\fixme{true to model this way? how to model a suspension of particles?} --> If we do not want to model individual matters, we can use a single absorption coefficient to describe the aggregate behavior of the mixture. That absorption coefficient does have a physical meaning: it is the concentration-weighted sum of the individual absorption coefficients.</p>
<p>There are a bunch of other quantities defined in the literature. The state of the definitions is a bit of a mess, largely because different communities use different definitions.</p>
<ul>
<li><p>In visual neuroscience people sometimes use a quantity called <strong>specific absorbance</strong> (see, e.g., <span class="citation" data-cites="bowmaker1980visual">Bowmaker and Dartnall (<a href="references.html#ref-bowmaker1980visual" role="doc-biblioref">1980</a>)</span>), which is the absorbance per unit length <span class="math inline">\(\frac{A}{s}\)</span>. Whenever you see a quantity that starts with the word “specific”, chances are that the quantity is defined per unit length. You can see that specific absorbance is actually just our absorption coefficient.</p></li>
<li><p>In scientific communities, especially chemistry and spectroscopy, people define <span class="math inline">\(\epsilon\)</span>, rather than <span class="math inline">\(c\epsilon\)</span>, to be the absorption coefficient. You can see the appeal of doing that — <span class="math inline">\(\epsilon\)</span> is a more fundamental measure of a medium’s ability to absorb photons, independent of the particle concentration <span class="math inline">\(c\)</span> (and certainly independent of the traversal length <span class="math inline">\(s\)</span>).</p></li>
<li><p>The absorbance defined in <a href="#eq-absorbance" class="quarto-xref">Equation&nbsp;<span>14.9</span></a> is technically called the <strong>Naperian absorbance</strong>, because we take the natural logarithm of <span class="math inline">\(T\)</span>. Sometimes people also use the <strong>decadic absorbance</strong>, which is defined as <span class="math inline">\(-\log T\)</span>. This quantity is also called the <strong>optical density</strong>.</p></li>
<li><p>Finally, the number concentration <span class="math inline">\(c\)</span> here is defined in terms of the absolute quantity per unit volume, but sometimes people want to define <span class="math inline">\(c\)</span> as the <strong>molar concentration</strong>, which is the number of moles per unit volume. If so, all other derived quantities are then prefixed with “molar”. Next time when you see something like the <strong>molar decadic absorption coefficient</strong>, you know what it is!</p></li>
</ul>
<p>The annoying thing is that people do not always tell you which definition they use. The plea I have to you is to be specific about which definition <em>you</em> use in your writing and tell me when I am being vague!</p>
</section>
<section id="general-case" class="level2" data-number="14.4">
<h2 data-number="14.4" class="anchored" data-anchor-id="general-case"><span class="header-section-number">14.4</span> General Case</h2>
<p>So far we have assumed that the absorption coefficient <span class="math inline">\(\sigma_a = c\epsilon\)</span> is a constant regardless of the position <span class="math inline">\(p\)</span> in the medium and along any direction <span class="math inline">\(\omega\)</span>. The former property assumes that the medium is uniform, and the latter property is called <strong>isotropic</strong><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> in that the medium’s ability to absorb photons is independent of the light direction.</p>
<p>Both assumptions are problematic in practice. The concentration can change spatially and should be denoted <span class="math inline">\(c(p)\)</span>, where <span class="math inline">\(p\)</span> is an arbitrary position in space. <span class="math inline">\(\epsilon\)</span> can also change with <span class="math inline">\(p\)</span> and, more importantly, change with the direction of light incidence <span class="math inline">\(\omega\)</span>. For instance, the particles might not be spherical, so their geometrical cross-sectional area and, thus, the cross section <span class="math inline">\(\epsilon\)</span> available for absorbing photons can depend on <span class="math inline">\(\omega\)</span>. As a result, the absorption coefficient should generally be denoted <span class="math inline">\(\sigma_a(p, \omega)\)</span>.</p>
<div id="fig-absorption_model_general" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-absorption_model_general-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figs/absorption_model_general.svg" class="img-fluid figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-absorption_model_general-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14.2: A conceptual model to help reason about photon absorption in the general case, where the absorption coefficient can vary spatially and directionally. The medium is divided into many tiny elemental volumes, each of which is so small that particles do not cover each from any direction.
</figcaption>
</figure>
</div>
<p>Effectively, our conceptual model, shown in <a href="#fig-absorption_model_general" class="quarto-xref">Figure&nbsp;<span>14.2</span></a>, has to be changed to one where the entire body of particles is divided into many equally-sized volumes (with a length <span class="math inline">\(\D s\)</span> and an area <span class="math inline">\(\D A\)</span>), each of which is so small that particles do not cover each other from any direction. The radiance reduction per unit length in a small volume is then expressed as:</p>
<p><span id="eq-abs_dif_cont"><span class="math display">\[
\begin{align}
    \frac{\D L(p, \omega)}{\D s} = -\sigma_a(p, \omega)L.
\end{align}
\tag{14.12}\]</span></span></p>
<p>Given this model, we can calculate the exitant radiance after light travels a length <span class="math inline">\(s\)</span> through the medium:</p>
<p><span id="eq-abs_cont"><span class="math display">\[
\begin{align}
    L(p+s\omega, \omega) = L(p, \omega) e^{-\int_0^s \sigma_a(p+t\omega, \omega) \d t},
\end{align}
\tag{14.13}\]</span></span></p>
<p>where <span class="math inline">\(\omega\)</span> is the (unit) direction of the incident radiance, <span class="math inline">\(L(p, \omega)\)</span> is the incident radiance, and <span class="math inline">\(L(p+s\omega, \omega)\)</span> is the exitance radiance (radiance toward <span class="math inline">\(\omega\)</span> leaving the entire medium after traveling <span class="math inline">\(s\)</span>).</p>
<p>You would notice that for a beam with an oblique incident direction, the distance traveled, say <span class="math inline">\(\D s'\)</span>, can be different (longer or shorter than) from <span class="math inline">\(\D s\)</span>. Our model can account for this by folding the factor <span class="math inline">\(\D s'/\D s\)</span> specific to a particular direction <span class="math inline">\(\omega'\)</span> into the absorption coefficient <span class="math inline">\(\sigma_a(p, \omega')\)</span>. Note that the <span class="math inline">\(\D s'/\D s\)</span> factor should be the average for all the incident photons with the same direction <span class="math inline">\(\omega'\)</span> across the entire <span class="math inline">\(\D A\)</span>.</p>
</section>
<section id="nature-and-applicability-of-the-model" class="level2" data-number="14.5">
<h2 data-number="14.5" class="anchored" data-anchor-id="nature-and-applicability-of-the-model"><span class="header-section-number">14.5</span> Nature and Applicability of the Model</h2>
<p>The absorption model (the BBL law) derived before (<a href="#eq-abs_4" class="quarto-xref">Equation&nbsp;<span>14.4</span></a> and <a href="#eq-abs_cont" class="quarto-xref">Equation&nbsp;<span>14.13</span></a>) is a continuous one, but it is derived based on modeling discrete particles and events. It is another example of the modeling methodology discussed on <a href="rendering-surfacemodeling.html#sec-chpt-mat-ss-para-model" class="quarto-xref"><span>Section 12.2.1</span></a>.</p>
<p><a href="#eq-abs_cont" class="quarto-xref">Equation&nbsp;<span>14.13</span></a> seems to suggest that absorption coefficient <span class="math inline">\(\sigma_a(p, \omega)\)</span> is continuously defined at any position <span class="math inline">\(p\)</span> in the medium along any direction <span class="math inline">\(\omega\)</span>. It is not true. For starters, concentration <span class="math inline">\(c\)</span> is not continuous. Rather, it exhibits the triphasic profile shown in <a href="rendering-surfacemodeling.html#fig-model_scale" class="quarto-xref">Figure&nbsp;<span>12.2</span></a>. As we keep shrinking the size of the volume to the molecular scale, eventually the concentration depends on whether the tiny volume contains any molecules or not, so it becomes wildly discontinuous, not to mention the headache of dealing with a partial molecule in a volume — should it be counted or not? In general, the absorption coefficient can be an arbitrary discontinuous function that is not integrable.</p>
<p>What about <a href="#eq-abs_4" class="quarto-xref">Equation&nbsp;<span>14.4</span></a> where the absorption coefficient is uniform so we do not have to take the integral? Well, that is a lie too: concentration is not continuous, so it cannot be uniform everywhere, and, by extension, the absorption coefficient cannot be a constant everywhere either. So <a href="#eq-abs_3" class="quarto-xref">Equation&nbsp;<span>14.3</span></a> is technically wrong when we let <span class="math inline">\(\D s \rightarrow 0\)</span> (i.e., <span class="math inline">\(N \rightarrow \infty\)</span>), which is necessary for us to construct the differential equation (or take the limit in <a href="#eq-alt_abs_2" class="quarto-xref">Equation&nbsp;<span>14.6</span></a>). For <a href="#eq-abs_3" class="quarto-xref">Equation&nbsp;<span>14.3</span></a> to be true, the concentration/absorption coefficient must be a constant everywhere, which can be true only if the volume is continuous.</p>
<p>What has to happen is that the limit of <span class="math inline">\(\D s\)</span> cannot be literally 0 and the limit of <span class="math inline">\(N\)</span> cannot be infinity. What we do is to keep reducing <span class="math inline">\(\D s\)</span> to the point where the concentration (and thus absorption coefficient) is insensitive to slight perturbation of <span class="math inline">\(\D s\)</span> (i.e., operating in the stable range in <a href="rendering-surfacemodeling.html#fig-model_scale" class="quarto-xref">Figure&nbsp;<span>12.2</span></a>), and call it the concentration/absorption coefficient of that specific <span class="math inline">\(\D s\)</span>. And we repeat this for all the <span class="math inline">\(\D s\)</span>. This certainly applies to the general-case models in <a href="#eq-abs_dif_cont" class="quarto-xref">Equation&nbsp;<span>14.12</span></a> and <a href="#eq-abs_cont" class="quarto-xref">Equation&nbsp;<span>14.13</span></a>, where we iterate over not the thin slices <span class="math inline">\(\D s\)</span> but all the tiny volumes (<span class="math inline">\(\D A \times \D s\)</span>). So all the integral symbols are secretly summing over an extremely fine-grained grid.</p>
<p>How big of an error are we introducing here? Technically, we should sum all <span class="math inline">\(N\)</span> slices across the total traversal length <span class="math inline">\(s\)</span> in <a href="#eq-alt_abs_1" class="quarto-xref">Equation&nbsp;<span>14.5</span></a>. If we assume <span class="math inline">\(\D s\)</span> to be very small (even though not infinitesimal) compared to <span class="math inline">\(s\)</span>, <span class="math inline">\(N\)</span> would be large, so taking the integration (equivalent to letting <span class="math inline">\(N \rightarrow \infty\)</span>) would be very close to summing over <span class="math inline">\(N\)</span>. Similarly, the integral in should have been a summation of the concentration in each of the <span class="math inline">\(N\)</span> slices. If you want to be pedantic, however, the integration there is exact: we can model <span class="math inline">\(c\)</span> as a piece-wise function, where the value at each piece is the concentration of the corresponding volume. Integrating over a piece-wise function is the same as summing all the pieces. Only the exponential expression in <a href="#eq-abs_cont" class="quarto-xref">Equation&nbsp;<span>14.13</span></a> is inexact.</p>
<p>The discontinuity of the medium is, of course, orthogonal to the discontinuity and non-uniformity in the light field itself. For instance, the fact that we use <span class="math inline">\(\frac{cE\D l\epsilon}{E}\)</span> as the percentage of photon absorption in <a href="#eq-abs_1" class="quarto-xref">Equation&nbsp;<span>14.1</span></a> (and implicitly in <a href="#eq-abs_4" class="quarto-xref">Equation&nbsp;<span>14.4</span></a>) assumes that the irradiance of the incident illumination is continuous and uniform in the small volume. This is technically not true because photons are discrete packets of energy. But in practice this is not a concern because we can assume that there is an enormous amount of photons incident on the small volume, and these photons are randomly distributed. <!-- %on the same point, Bohren p. 110 ``Implicit in the definition of cross sections is that the irradiance of the incident illumination be constant over lateral dimensions large compared with the size of the particle.'' --></p>
<p>In essence, we are using the aggregated behavior of many photons to model the behavior of a small volume. This is similar to the microfacet models, where we use the aggregated behavior of many microfacets to statistically model the behavior of a small macro-surface.</p>
<p>This sort of modeling strategy is a weird case where the discrete model provides the “ground truth”, which is approximated by a continuous model. I say ground truth — to the extent that the geometrical optics can approximate the electromagnetic theory of light-matter interaction. The BBL law fails when the wave nature of photons has to be considered <span class="citation" data-cites="mayerhofer2020bouguer">(<a href="references.html#ref-mayerhofer2020bouguer" role="doc-biblioref">Mayerhöfer, Pahlow, and Popp 2020</a>)</span>.</p>
<!-- \fixme{talk about distribution of the particles. they can't be non-random: two extreme cases.} -->


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-bohren2006fundamentals" class="csl-entry" role="listitem">
Bohren, Craig F, and Eugene E Clothiaux. 2006. <em>Fundamentals of Atmospheric Radiation: An Introduction with 400 Problems</em>. John Wiley &amp; Sons.
</div>
<div id="ref-bowmaker1980visual" class="csl-entry" role="listitem">
Bowmaker, James K, and HJk Dartnall. 1980. <span>“Visual Pigments of Rods and Cones in a Human Retina.”</span> <em>The Journal of Physiology</em> 298 (1): 501–11.
</div>
<div id="ref-mayerhofer2020bouguer" class="csl-entry" role="listitem">
Mayerhöfer, Thomas G, Susanne Pahlow, and Jürgen Popp. 2020. <span>“The Bouguer-Beer-Lambert Law: Shining Light on the Obscure.”</span> <em>ChemPhysChem</em> 21 (18): 2029–46.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>“Isotropic” is a very overloaded term; it just means some physical property is invariant when measured from different directions. So depending on what physical property you care about, “isotropic” can mean different things. The property we care about here is a volume’s ability to absorb photons, which is different from our earlier use of isotropy, which is concerned with the ability of a surface to scatter photons.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./rendering-sss.html" class="pagination-link" aria-label="Subsurface and Volume Scattering">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Subsurface and Volume Scattering</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./rendering-scattering.html" class="pagination-link" aria-label="Scattering">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Scattering</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>